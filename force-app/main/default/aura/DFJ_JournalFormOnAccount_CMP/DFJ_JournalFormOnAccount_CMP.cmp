<aura:component description="DFJ_JournalForm" implements="force:lightningQuickActionWithoutHeader,force:hasRecordId,force:hasSObjectName,flexipage:availableForAllPageTypes,lightning:actionOverride" controller="DFJ_JournalForm" access="global">
     
    <ltng:require styles="{!$Resource.DFj_JournalCSS}" />
    <aura:attribute name="sObjectName" type="String" />
    <aura:attribute name="recordId" type="String" default="" />
    <!--Changes Start DFJ-77-->
    <aura:attribute name="orderId" type="String" default="" />
    <aura:attribute name="relatedOrders" type="List" />

    <!--End-->
    <aura:attribute name="journalId" type="String" default="" />
    <aura:attribute name="errorLog" type="Log__c" access="global" default="{'sObjectType' : 'Log__c'}" />

    <aura:attribute name="docFabFormUrl" type="String" description="contains docFab form url" />
    <aura:attribute name="openDocFabForm" type="Boolean" description="to open docFab form" />
    <aura:attribute name="isOpenJournalFormClicked" type="Boolean" default="false" />
    <aura:attribute name="isSpinnerOpen" type="Boolean" default="false" />
    <aura:attribute name="isAddedConfirmationModalOpen" type="Boolean" default="false" />

    
    <!--aura:handler name="init" value="{!this}" action="{!c.doInit}" /-->
    <aura:attribute name="closeModal" type="Boolean" default="false" access="global" />
    
    
    <lightning:layout>
        <lightning:layoutItem size="12" largeDeviceSize="12" mediumDeviceSize="12" smallDeviceSize="12">
            <div align="right" class="slds-p-around_x-small slds-card">
                <lightning:button label="Create New Journal" title="Add New Journal" iconName="utility:add" iconPosition="left" variant="brand" onclick="{!c.showJournalForm}" class="slds-button_stretch"/>
            </div>
        </lightning:layoutItem>
    </lightning:layout>

    
    <aura:if isTrue="{!v.closeModal}">
    <section role="dialog" tabindex="-1" aria-labelledby="modal-heading-01" aria-modal="true" aria-describedby="modal-content-id-1" class="slds-modal slds-fade-in-open">
        <div class="slds-modal__container">

            <!--###### MODAL BOX BODY Part Start######-->
            <div class="slds-modal__content slds-p-around_medium" id="modal-content-id-1">
                <div>
                    <aura:if isTrue="{!v.isSpinnerOpen}">
                        <div>
                            <lightning:spinner variant="brand" size="large" alternativeText="Loading" />
                        </div>
                    </aura:if>
                    <div>
                        <aura:if isTrue="{!v.sObjectName == 'Account'}">
                            <div class="slds-align_absolute-center">Loading...</div>
                        </aura:if>
                    </div>
                </div>
            </div>
        </div>
    </section>
                   
    <div class="slds-backdrop slds-backdrop_open"></div>
   </aura:if>                 
    <aura:if isTrue="{!v.openDocFabForm}">
        <c:DF_DocFabricatorForm_CMP docFabFormUrl="{!v.docFabFormUrl}" openDocFabForm="{!v.openDocFabForm}" />
    </aura:if>

    <aura:if isTrue="{!v.isAddedConfirmationModalOpen}">
        <!--###### MODAL BOX Start######-->
        <section role="dialog" tabindex="-1" aria-labelledby="modal-heading-02" aria-modal="true" aria-describedby="modal-content-id-2" class="slds-modal slds-fade-in-open">
            <div class="slds-modal__container">

                <header class="slds-modal__header">
                    <!-- <lightning:buttonIcon iconName="utility:close" onclick="{!c.closeModal }" alternativeText="close" variant="bare-inverse" class="slds-modal__close" /> -->
                    <h2 id="modal-heading-01" class="slds-text-heading_medium slds-hyphenate"><b>Create New Journal</b></h2>
                </header>
                <!--###### MODAL BOX BODY Part Start######-->
                <div class="slds-modal__content slds-p-around_medium" id="modal-content-id-2">
                    
                <!--Changes DFJ-77 Starts-->
                     <lightning:select name="orderList" title="Select Order to relate with Journal" label="Related Orders" aura:id="OrderList" onchange="{!c.handleValuePassed}">
        			 <option value="">--None--</option>
        			<aura:iteration items="{!v.relatedOrders}" var="order">
            			<option value="{!order.Id}">{!order.Account.Name} : Value - {!order.Provision_Value__c}</option>
        			</aura:iteration>
    				</lightning:select>
                <!--End-->
                    
                    <lightning:layout multipleRows="true">
                        <lightning:layoutItem size="12" largeDeviceSize="12" mediumDeviceSize="12" smallDeviceSize="12">
                            <div class="slds-align_absolute-center slds-text-heading_medium slds-p-around_medium">
                                <p>Are you sure you want to create a new journal on this account?</p>
                            </div>
                        </lightning:layoutItem>
                        <div align="right" class="slds-p-around_medium slds-align_absolute-center">
                            <lightning:button variant="brand" label='Create new journal' title='Create new Journal' onclick="{!c.addedNewJournalButtonClicked}" iconName="utility:check" iconPosition="left" ></lightning:button>
                            <lightning:button class="addSpaceInFooter" type="button" label="Cancel" onclick="{!c.closeModal }" variant="neutral" title="Cancel"  iconName="utility:close" iconPosition="left"></lightning:button>
                        </div>
  
                    </lightning:layout>
                </div>

            </div>
        </section>
        <div class="slds-backdrop slds-backdrop_open"></div>
        <!--###### MODAL BOX Part END Here ######-->
    </aura:if>


</aura:component>