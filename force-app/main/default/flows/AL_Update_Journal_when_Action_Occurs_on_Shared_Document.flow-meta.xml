<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata">
    <actionCalls>
        <name>Send_Email</name>
        <label>Send Email</label>
        <locationX>0</locationX>
        <locationY>0</locationY>
        <actionName>emailSimple</actionName>
        <actionType>emailSimple</actionType>
        <connector>
            <targetReference>Update_Journal</targetReference>
        </connector>
        <faultConnector>
            <isGoTo>true</isGoTo>
            <targetReference>Populate_Custom_Error_with_Flow_Fault_Message</targetReference>
        </faultConnector>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>emailAddresses</name>
            <value>
                <elementReference>ToEmail</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>senderType</name>
            <value>
                <stringValue>OrgWideEmailAddress</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>senderAddress</name>
            <value>
                <elementReference>FromAddress</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>useEmailTemplate</name>
            <value>
                <stringValue>True</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>emailTemplateId</name>
            <value>
                <elementReference>EmailTemplateId</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>recipientId</name>
            <value>
                <elementReference>SharedDocument.Journal__r.Account__r.PersonContactId__c</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>relatedRecordId</name>
            <value>
                <elementReference>SharedDocument.Journal__c</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>logEmailOnSend</name>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </inputParameters>
        <nameSegment>emailSimple</nameSegment>
    </actionCalls>
    <actionCalls>
        <name>Send_Slack_Message</name>
        <label>Send Slack Message</label>
        <locationX>0</locationX>
        <locationY>0</locationY>
        <actionName>slackPostMessage</actionName>
        <actionType>slackPostMessage</actionType>
        <faultConnector>
            <isGoTo>true</isGoTo>
            <targetReference>Populate_Custom_Error_with_Flow_Fault_Message</targetReference>
        </faultConnector>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>slackAppIdForToken</name>
            <value>
                <stringValue>A03269G3DNE</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>slackWorkspaceIdForToken</name>
            <value>
                <stringValue>TVAHYDPPH</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>slackConversationId</name>
            <value>
                <stringValue>C05UJ7ZJYCU</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>slackMessage</name>
            <value>
                <elementReference>SlackMessage</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>recordId</name>
            <value>
                <elementReference>SharedDocument.Journal__c</elementReference>
            </value>
        </inputParameters>
        <nameSegment>slackPostMessage</nameSegment>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </actionCalls>
    <apiVersion>64.0</apiVersion>
    <assignments>
        <name>Assign_Approval_Email_Values</name>
        <label>Assign Approval Email Values</label>
        <locationX>0</locationX>
        <locationY>0</locationY>
        <assignmentItems>
            <assignToReference>EmailTemplate</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>ApprovalEmailTemplate</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Assign_Approved_Values_to_Shared_Document</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_Approved_Values_to_Shared_Document</name>
        <label>Assign Approved Values to Shared Document</label>
        <locationX>0</locationX>
        <locationY>0</locationY>
        <assignmentItems>
            <assignToReference>SharedDocument.Approval_Email_Status__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Sent</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Does_Document_Require_Public_Registration</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_Complete_to_Journal_States</name>
        <label>Assign Complete to Journal States</label>
        <locationX>0</locationX>
        <locationY>0</locationY>
        <assignmentItems>
            <assignToReference>Journal.Journal_States__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>complete</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>Journal.All_Shared_Documents_Approved__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>Journal.Approval_Date__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Flow.CurrentDateTime</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Do_We_Need_to_Send_an_Email</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_Completed_Values_to_Shared_Document</name>
        <label>Assign Completed Values to Shared Document</label>
        <locationX>0</locationX>
        <locationY>0</locationY>
        <assignmentItems>
            <assignToReference>SharedDocument.Public_Registration_Status__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Public Registration Complete</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>SharedDocument.Completion_Email_Status__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Sent</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Get_Shared_Documents</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_Completion_Email_Values</name>
        <label>Assign Completion Email Values</label>
        <locationX>0</locationX>
        <locationY>0</locationY>
        <assignmentItems>
            <assignToReference>EmailTemplate</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>CompletionEmailTemplate</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Assign_Completed_Values_to_Shared_Document</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_Gennemgang_GetAccept_as_no_Existing_Docs_Awaiting_Registration</name>
        <label>Assign Gennemgang GetAccept as no Existing Docs Awaiting Registration</label>
        <locationX>0</locationX>
        <locationY>0</locationY>
        <assignmentItems>
            <assignToReference>Journal.Journal_States__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Gennemgang Get Accept</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Loop_Unapproved_Documents</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_IsSuccess_False</name>
        <label>Assign IsSuccess False</label>
        <locationX>0</locationX>
        <locationY>0</locationY>
        <assignmentItems>
            <assignToReference>IsSuccess</assignToReference>
            <operator>Assign</operator>
            <value>
                <booleanValue>false</booleanValue>
            </value>
        </assignmentItems>
    </assignments>
    <assignments>
        <name>Assign_Primary_Contact_s_Email_to_ToEmail</name>
        <label>Assign Primary Contact&apos;s Email to ToEmail</label>
        <locationX>0</locationX>
        <locationY>0</locationY>
        <assignmentItems>
            <assignToReference>ToEmail</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>SharedDocument.Journal__r.Account__r.PersonEmail</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Get_Email_Template</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_Public_Registration_Required_Values</name>
        <label>Assign Public Registration Required Values</label>
        <locationX>0</locationX>
        <locationY>0</locationY>
        <assignmentItems>
            <assignToReference>Journal.Journal_States__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Tinglysning</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>SharedDocument.Was_Approved__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>SharedDocument.Public_Registration_Status__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Ready for Public Registration</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <isGoTo>true</isGoTo>
            <targetReference>Do_We_Need_to_Send_an_Email</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_Spouse_s_Email_to_ToEmail</name>
        <label>Assign Spouse&apos;s Email to ToEmail</label>
        <locationX>0</locationX>
        <locationY>0</locationY>
        <assignmentItems>
            <assignToReference>ToEmail</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>SharedDocument.Journal__r.Account__r.Spouse_Email__pc</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Get_Email_Template</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_Tinglysning_Due_to_Existing_Doc_Awaiting_Registration</name>
        <label>Assign Tinglysning Due to Existing Doc Awaiting Registration</label>
        <locationX>0</locationX>
        <locationY>0</locationY>
        <assignmentItems>
            <assignToReference>Journal.Journal_States__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Tinglysning</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Loop_Unapproved_Documents</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Copy_1_of_Populate_Custom_Error_with_No_Matching_Document_Approval_Email_Rule_Ex</name>
        <label>Populate Custom Error with Missing or Invalid Document Action</label>
        <locationX>0</locationX>
        <locationY>0</locationY>
        <assignmentItems>
            <assignToReference>CustomError</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>Missing or Invalid Document Action (Valid Values are &quot;Approved&quot; and &quot;Registered&quot;)</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <isGoTo>true</isGoTo>
            <targetReference>Assign_IsSuccess_False</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Populate_Custom_Error_with_Flow_Fault_Message</name>
        <label>Populate Custom Error with Flow Fault Message</label>
        <locationX>0</locationX>
        <locationY>0</locationY>
        <assignmentItems>
            <assignToReference>CustomError</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Flow.FaultMessage</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Assign_IsSuccess_False</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Populate_Custom_Error_with_No_Matching_Document_Approval_Email_Rule_Exists</name>
        <label>Populate Custom Error with No Matching Document Approval Email Rule Exists</label>
        <locationX>0</locationX>
        <locationY>0</locationY>
        <assignmentItems>
            <assignToReference>CustomError</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>No Matching Document Approval Email Rule Exists: Searched for Market Unit &quot;{!SharedDocument.Market_Unit__c}&quot; and Document Type &quot;{!SharedDocument.Document_Type__c}&quot;</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <isGoTo>true</isGoTo>
            <targetReference>Assign_IsSuccess_False</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Populate_Journal_Variable_with_Journal_ID</name>
        <label>Populate Journal Variable with Journal ID</label>
        <locationX>0</locationX>
        <locationY>0</locationY>
        <assignmentItems>
            <assignToReference>Journal.Id</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>SharedDocument.Journal__c</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Get_Document_Approval_Email_Rule</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Populate_Slack_Message_with_Missing_Recipient</name>
        <label>Populate Slack Message with Missing Recipient</label>
        <locationX>0</locationX>
        <locationY>0</locationY>
        <assignmentItems>
            <assignToReference>SlackMessage</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>ptMissingContactDetailsSlackMessage</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Send_Slack_Message</targetReference>
        </connector>
    </assignments>
    <decisions>
        <name>Did_We_Find_any_Unapproved_Documents</name>
        <label>Did We Find any Unapproved Documents?</label>
        <locationX>0</locationX>
        <locationY>0</locationY>
        <defaultConnector>
            <targetReference>Assign_Complete_to_Journal_States</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No More Unapproved Documents</defaultConnectorLabel>
        <rules>
            <name>Got_Unapproved_Documents</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Get_Shared_Documents</leftValueReference>
                <operator>IsEmpty</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Loop_Unapproved_Documents</targetReference>
            </connector>
            <label>Got Unapproved Documents</label>
        </rules>
    </decisions>
    <decisions>
        <name>Did_We_Find_Document_Approval_Email_Rules</name>
        <label>Did We Find Document Approval Email Rules?</label>
        <locationX>0</locationX>
        <locationY>0</locationY>
        <defaultConnector>
            <targetReference>Populate_Custom_Error_with_No_Matching_Document_Approval_Email_Rule_Exists</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Got_Document_Approval_Email_Rules</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>DocumentApprovalEmailRuleId</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Which_Action_Occurred</targetReference>
            </connector>
            <label>Got Document Approval Email Rules</label>
        </rules>
    </decisions>
    <decisions>
        <name>Do_We_Have_an_Email_Address</name>
        <label>Do We Have an Email Address?</label>
        <locationX>0</locationX>
        <locationY>0</locationY>
        <defaultConnector>
            <targetReference>Populate_Slack_Message_with_Missing_Recipient</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Got_Email_Address</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>SharedDocument.Journal__r.Account__r.PersonEmail</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Should_We_Also_Send_to_a_Spouse</targetReference>
            </connector>
            <label>Got Email Address</label>
        </rules>
    </decisions>
    <decisions>
        <name>Do_We_Need_to_Send_an_Email</name>
        <label>Do We Need to Send an Email?</label>
        <locationX>0</locationX>
        <locationY>0</locationY>
        <defaultConnector>
            <targetReference>Update_Journal</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No Approval Email</defaultConnectorLabel>
        <rules>
            <name>An_Email_is_Required</name>
            <conditionLogic>(1 AND 2) OR (3 AND 4)</conditionLogic>
            <conditions>
                <leftValueReference>IsApprovalEmailRequired</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>inputDocumentAction</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Approved</stringValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>IsCompletionEmailRequired</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <conditions>
                <leftValueReference>inputDocumentAction</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Completed</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Do_We_Have_an_Email_Address</targetReference>
            </connector>
            <label>An Email is Required</label>
        </rules>
    </decisions>
    <decisions>
        <name>Does_Document_Require_Public_Registration</name>
        <label>Does Document Require Public Registration?</label>
        <locationX>0</locationX>
        <locationY>0</locationY>
        <defaultConnector>
            <targetReference>Get_Shared_Documents</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No Public Registration</defaultConnectorLabel>
        <rules>
            <name>Public_Registration_Required</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>IsPublicRegistrationRequired</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Assign_Public_Registration_Required_Values</targetReference>
            </connector>
            <label>Public Registration Required</label>
        </rules>
    </decisions>
    <decisions>
        <name>Is_Document_Awaiting_Public_Registration</name>
        <label>Is Document Awaiting Public Registration?</label>
        <locationX>0</locationX>
        <locationY>0</locationY>
        <defaultConnector>
            <targetReference>Assign_Gennemgang_GetAccept_as_no_Existing_Docs_Awaiting_Registration</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Is_Ready_Public_Registration</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Loop_Unapproved_Documents.Public_Registration_Status__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Ready for Public Registration</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Assign_Tinglysning_Due_to_Existing_Doc_Awaiting_Registration</targetReference>
            </connector>
            <label>Is Ready Public Registration</label>
        </rules>
    </decisions>
    <decisions>
        <name>Should_We_Also_Send_to_a_Spouse</name>
        <label>Should We Also Send to a Spouse?</label>
        <locationX>0</locationX>
        <locationY>0</locationY>
        <defaultConnector>
            <targetReference>Assign_Primary_Contact_s_Email_to_ToEmail</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Also_Notify_Spouse</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>SharedDocument.Journal__r.Account__r.Is_Spouse_Shared_Document_Recipient__pc</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Assign_Spouse_s_Email_to_ToEmail</targetReference>
            </connector>
            <label>Also Notify Spouse</label>
        </rules>
    </decisions>
    <decisions>
        <name>Which_Action_Occurred</name>
        <label>Which Action Occurred?</label>
        <locationX>0</locationX>
        <locationY>0</locationY>
        <defaultConnector>
            <targetReference>Copy_1_of_Populate_Custom_Error_with_No_Matching_Document_Approval_Email_Rule_Ex</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Invalid Action</defaultConnectorLabel>
        <rules>
            <name>Document_Was_Approved</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>inputDocumentAction</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Approved</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Assign_Approval_Email_Values</targetReference>
            </connector>
            <label>Document Was Approved</label>
        </rules>
        <rules>
            <name>Document_Was_Registered</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>inputDocumentAction</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Registered</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Assign_Completion_Email_Values</targetReference>
            </connector>
            <label>Document Was Registered</label>
        </rules>
    </decisions>
    <environments>Default</environments>
    <interviewLabel>AL - Update Journal when Action Occurs on Shared Document {!$Flow.CurrentDateTime}</interviewLabel>
    <label>AL - Update Journal when Action Occurs on Shared Document</label>
    <loops>
        <name>Loop_Unapproved_Documents</name>
        <label>Loop Unapproved Documents</label>
        <locationX>0</locationX>
        <locationY>0</locationY>
        <collectionReference>Get_Shared_Documents</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Is_Document_Awaiting_Public_Registration</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Do_We_Need_to_Send_an_Email</targetReference>
        </noMoreValuesConnector>
    </loops>
    <processMetadataValues>
        <name>BuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>CanvasMode</name>
        <value>
            <stringValue>AUTO_LAYOUT_CANVAS</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>OriginBuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processType>AutoLaunchedFlow</processType>
    <recordLookups>
        <name>Get_Document_Approval_Email_Rule</name>
        <label>Get Document Approval Email Rule</label>
        <locationX>0</locationX>
        <locationY>0</locationY>
        <assignNullValuesIfNoRecordsFound>true</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Did_We_Find_Document_Approval_Email_Rules</targetReference>
        </connector>
        <faultConnector>
            <targetReference>Populate_Custom_Error_with_Flow_Fault_Message</targetReference>
        </faultConnector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Market_Unit__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>SharedDocument.Market_Unit__c</elementReference>
            </value>
        </filters>
        <filters>
            <field>Document_Type__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>SharedDocument.Document_Type__c</elementReference>
            </value>
        </filters>
        <object>Document_Approval_Email_Rule__mdt</object>
        <outputAssignments>
            <assignToReference>ApprovalEmailTemplate</assignToReference>
            <field>Approval_Email_Template_Developer_Name__c</field>
        </outputAssignments>
        <outputAssignments>
            <assignToReference>CompletionEmailTemplate</assignToReference>
            <field>Completion_Email_Template_Developer_Name__c</field>
        </outputAssignments>
        <outputAssignments>
            <assignToReference>FromAddress</assignToReference>
            <field>FromEmail__c</field>
        </outputAssignments>
        <outputAssignments>
            <assignToReference>DocumentApprovalEmailRuleId</assignToReference>
            <field>Id</field>
        </outputAssignments>
        <outputAssignments>
            <assignToReference>IsApprovalEmailRequired</assignToReference>
            <field>Requires_Email_on_Approval__c</field>
        </outputAssignments>
        <outputAssignments>
            <assignToReference>IsCompletionEmailRequired</assignToReference>
            <field>Requires_Email_on_Completion__c</field>
        </outputAssignments>
        <outputAssignments>
            <assignToReference>IsPublicRegistrationRequired</assignToReference>
            <field>Requires_Public_Registration__c</field>
        </outputAssignments>
        <sortField>SystemModstamp</sortField>
        <sortOrder>Desc</sortOrder>
    </recordLookups>
    <recordLookups>
        <name>Get_Email_Template</name>
        <label>Get Email Template</label>
        <locationX>0</locationX>
        <locationY>0</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Send_Email</targetReference>
        </connector>
        <faultConnector>
            <isGoTo>true</isGoTo>
            <targetReference>Populate_Custom_Error_with_Flow_Fault_Message</targetReference>
        </faultConnector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>DeveloperName</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>EmailTemplate</elementReference>
            </value>
        </filters>
        <object>EmailTemplate</object>
        <outputAssignments>
            <assignToReference>EmailTemplateId</assignToReference>
            <field>Id</field>
        </outputAssignments>
    </recordLookups>
    <recordLookups>
        <name>Get_Shared_Documents</name>
        <label>Get Shared Documents</label>
        <locationX>0</locationX>
        <locationY>0</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Did_We_Find_any_Unapproved_Documents</targetReference>
        </connector>
        <faultConnector>
            <isGoTo>true</isGoTo>
            <targetReference>Populate_Custom_Error_with_Flow_Fault_Message</targetReference>
        </faultConnector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Journal__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>SharedDocument.Journal__c</elementReference>
            </value>
        </filters>
        <filters>
            <field>Id</field>
            <operator>NotEqualTo</operator>
            <value>
                <elementReference>SharedDocument.Id</elementReference>
            </value>
        </filters>
        <filters>
            <field>Is_Newest_Version__c</field>
            <operator>EqualTo</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </filters>
        <filters>
            <field>Status__c</field>
            <operator>NotEqualTo</operator>
            <value>
                <stringValue>Approved</stringValue>
            </value>
        </filters>
        <getFirstRecordOnly>false</getFirstRecordOnly>
        <object>Shared_Document__c</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordUpdates>
        <name>Update_Journal</name>
        <label>Update Journal</label>
        <locationX>0</locationX>
        <locationY>0</locationY>
        <faultConnector>
            <isGoTo>true</isGoTo>
            <targetReference>Populate_Custom_Error_with_Flow_Fault_Message</targetReference>
        </faultConnector>
        <inputReference>Journal</inputReference>
    </recordUpdates>
    <start>
        <locationX>0</locationX>
        <locationY>0</locationY>
        <connector>
            <targetReference>Populate_Journal_Variable_with_Journal_ID</targetReference>
        </connector>
    </start>
    <status>Draft</status>
    <textTemplates>
        <name>ptMissingContactDetailsSlackMessage</name>
        <isViewedAsPlainText>true</isViewedAsPlainText>
        <text>:warning: *Missing Contact Information*

The document *&lt;{!SharedDocument.Id}|{!SharedDocument.Document_Type__c}&gt;* was just approved and requires an Approval Email.  
However, we have no valid email on the Account.

Please make sure to manually get this info and send the required information to the customer.

Link to journal: &lt;https://dfj.lightning.force.com/lightning/r/{!SharedDocument.Journal__c}/view|Open Journal&gt;</text>
    </textTemplates>
    <variables>
        <name>ApprovalEmailTemplate</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>CompletionEmailTemplate</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>CustomError</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <name>DocumentApprovalEmailRuleId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>EmailTemplate</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>EmailTemplateId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>FromAddress</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>inputDocumentAction</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>IsApprovalEmailRequired</name>
        <dataType>Boolean</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <value>
            <booleanValue>false</booleanValue>
        </value>
    </variables>
    <variables>
        <name>IsCompletionEmailRequired</name>
        <dataType>Boolean</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <value>
            <booleanValue>false</booleanValue>
        </value>
    </variables>
    <variables>
        <name>IsPublicRegistrationRequired</name>
        <dataType>Boolean</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <value>
            <booleanValue>false</booleanValue>
        </value>
    </variables>
    <variables>
        <name>IsSuccess</name>
        <dataType>Boolean</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>true</isOutput>
        <value>
            <booleanValue>false</booleanValue>
        </value>
    </variables>
    <variables>
        <name>Journal</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Journal__c</objectType>
    </variables>
    <variables>
        <name>JournalStates</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>SharedDocument</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>false</isOutput>
        <objectType>Shared_Document__c</objectType>
    </variables>
    <variables>
        <name>SlackMessage</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>ToEmail</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
</Flow>
