<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata">
    <actionCalls>
        <name>Lead_Convert_Action</name>
        <label>Lead Convert Action</label>
        <locationX>666</locationX>
        <locationY>2435</locationY>
        <actionName>LeadConverterClass</actionName>
        <actionType>apex</actionType>
        <connector>
            <targetReference>Was_Conversion_Successful</targetReference>
        </connector>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>convertStatus</name>
            <value>
                <stringValue>Converted</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>createOpportunity</name>
            <value>
                <booleanValue>false</booleanValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>leadId</name>
            <value>
                <elementReference>Get_Lead.Id</elementReference>
            </value>
        </inputParameters>
        <nameSegment>LeadConverterClass</nameSegment>
        <outputParameters>
            <assignToReference>accountId</assignToReference>
            <name>accountId</name>
        </outputParameters>
        <outputParameters>
            <assignToReference>CustomError</assignToReference>
            <name>errorMessage</name>
        </outputParameters>
        <outputParameters>
            <assignToReference>IsConvertSuccess</assignToReference>
            <name>success</name>
        </outputParameters>
    </actionCalls>
    <actionCalls>
        <name>Send_Notification_Email</name>
        <label>Send Notification Email</label>
        <locationX>1282</locationX>
        <locationY>4379</locationY>
        <actionName>emailSimple</actionName>
        <actionType>emailSimple</actionType>
        <connector>
            <targetReference>Update_Opportunity</targetReference>
        </connector>
        <flowTransactionModel>CurrentTransaction</flowTransactionModel>
        <inputParameters>
            <name>emailAddresses</name>
            <value>
                <elementReference>toEmail</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>senderType</name>
            <value>
                <stringValue>OrgWideEmailAddress</stringValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>senderAddress</name>
            <value>
                <elementReference>fromEmail</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>emailSubject</name>
            <value>
                <elementReference>emailSubject</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>emailBody</name>
            <value>
                <elementReference>emailBody</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>sendRichBody</name>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </inputParameters>
        <inputParameters>
            <name>relatedRecordId</name>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </inputParameters>
        <inputParameters>
            <name>logEmailOnSend</name>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </inputParameters>
        <nameSegment>emailSimple</nameSegment>
    </actionCalls>
    <apiVersion>61.0</apiVersion>
    <assignments>
        <name>Add_Order_Product_to_Collection</name>
        <label>Add Order Product to Collection</label>
        <locationX>490</locationX>
        <locationY>3527</locationY>
        <assignmentItems>
            <assignToReference>orderProductCollection</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>orderProduct</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Loop_Opp_Products</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_Account_as_Recipient_ID</name>
        <label>Assign Account as Recipient ID</label>
        <locationX>1018</locationX>
        <locationY>539</locationY>
        <assignmentItems>
            <assignToReference>recipientId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.Account.PersonContactId</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>What_is_the_Opportunity_s_Record_Type</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_Contact_as_Recipient_ID</name>
        <label>Assign Contact as Recipient ID</label>
        <locationX>1282</locationX>
        <locationY>539</locationY>
        <assignmentItems>
            <assignToReference>recipientId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.ContactId</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>What_is_the_Opportunity_s_Record_Type</targetReference>
        </connector>
    </assignments>
    <assignments>
        <description>Currently sets mt@dinfamiliejurist.dk as a static value to email - needs to be updated.

toEmail should be {!$Record.Owner.Email}
fromEmail is correct already</description>
        <name>Assign_Email_Values_and_Reset_Notify_Field</name>
        <label>Assign Email Values and Reset Notify Field</label>
        <locationX>1282</locationX>
        <locationY>4271</locationY>
        <assignmentItems>
            <assignToReference>toEmail</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.Owner.Email</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>fromEmail</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>no-reply@dinfamiliejurist.dk</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>$Record.Notify_Owner__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <booleanValue>false</booleanValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>emailBody</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>rtEmail</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>emailSubject</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>An Opportunity was assigned to you</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Send_Notification_Email</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_Lead_as_Recipient_ID</name>
        <label>Assign Lead as Recipient ID</label>
        <locationX>1546</locationX>
        <locationY>539</locationY>
        <assignmentItems>
            <assignToReference>recipientId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.Lead__c</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>What_is_the_Opportunity_s_Record_Type</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_Opp_s_Account_ID_to_Variable</name>
        <label>Assign Opp&apos;s Account ID to Variable</label>
        <locationX>50</locationX>
        <locationY>2003</locationY>
        <assignmentItems>
            <assignToReference>accountId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.AccountId</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>leadId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.Lead__c</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Create_Order</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_Opp_s_Lead_ID_to_Variable</name>
        <label>Assign Opp&apos;s Lead ID to Variable</label>
        <locationX>490</locationX>
        <locationY>2219</locationY>
        <assignmentItems>
            <assignToReference>leadId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>$Record.Lead__c</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Is_Lead_Converted</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Populate_Order_and_Account_on_Opportunity</name>
        <label>Populate Order and Account on Opportunity</label>
        <locationX>402</locationX>
        <locationY>3203</locationY>
        <assignmentItems>
            <assignToReference>$Record.Order__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>orderId</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>$Record.AccountId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>accountId</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Loop_Opp_Products</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Populate_Order_Product_Variable</name>
        <label>Populate Order Product Variable</label>
        <locationX>490</locationX>
        <locationY>3419</locationY>
        <assignmentItems>
            <assignToReference>orderProduct.OrderId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>orderId</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>orderProduct.Product2Id</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_Opp_Products.Product2Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>orderProduct.UnitPrice</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_Opp_Products.UnitPrice</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>orderProduct.Quantity</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_Opp_Products.Quantity</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>orderProduct.Discount__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>frmDiscount</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>orderProduct.Provision_base__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_Opp_Products.PricebookEntry.Provision_base__c</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>orderProduct.PricebookEntryId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_Opp_Products.PricebookEntryId</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Add_Order_Product_to_Collection</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Populate_Variables_from_Account_from_Lead</name>
        <label>Populate Variables from Account from Lead</label>
        <locationX>314</locationX>
        <locationY>2543</locationY>
        <assignmentItems>
            <assignToReference>accountId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_Account_from_Lead.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>leadId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_Lead.Id</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Create_Order</targetReference>
        </connector>
    </assignments>
    <customErrors>
        <name>Custom_Error_Cannot_Convert_Opp_without_Price_Book</name>
        <label>Custom Error: Cannot Convert Opp without Price Book</label>
        <locationX>1282</locationX>
        <locationY>1787</locationY>
        <customErrorMessages>
            <errorMessage>You Must Set a Price Book before moving Opportunity to &quot;Closed Won&quot; - Add a Product to prompt Price Book Selection</errorMessage>
            <isFieldError>false</isFieldError>
        </customErrorMessages>
    </customErrors>
    <customErrors>
        <name>Custom_Error_No_Lead_or_Account_for_Convert</name>
        <label>Custom Error: No Lead or Account for Convert</label>
        <locationX>1018</locationX>
        <locationY>2111</locationY>
        <customErrorMessages>
            <errorMessage>You must set either Lead or Account to move Opportunity Stage to &quot;Closed Won&quot;</errorMessage>
            <fieldSelection>AccountId</fieldSelection>
            <isFieldError>true</isFieldError>
        </customErrorMessages>
        <customErrorMessages>
            <errorMessage>You must set either Lead or Account to move Opportunity Stage to &quot;Closed Won&quot;</errorMessage>
            <fieldSelection>Lead__c</fieldSelection>
            <isFieldError>true</isFieldError>
        </customErrorMessages>
    </customErrors>
    <customErrors>
        <name>Custom_Error_No_Products_on_Opportunity</name>
        <label>Custom Error: No Products on Opportunity</label>
        <locationX>1546</locationX>
        <locationY>1679</locationY>
        <customErrorMessages>
            <errorMessage>You cannot move an opportunity with no products on it to &quot;Closed Won&quot;</errorMessage>
            <isFieldError>false</isFieldError>
        </customErrorMessages>
    </customErrors>
    <customErrors>
        <name>Failed_to_Convert_Lead</name>
        <label>Failed to Convert Lead</label>
        <locationX>754</locationX>
        <locationY>2651</locationY>
        <connector>
            <targetReference>Create_Order</targetReference>
        </connector>
        <customErrorMessages>
            <errorMessage>Lead Conversion Failed</errorMessage>
            <isFieldError>false</isFieldError>
        </customErrorMessages>
    </customErrors>
    <customErrors>
        <name>Invalid_Record_Type_Error</name>
        <label>Invalid Record Type Error</label>
        <locationX>1722</locationX>
        <locationY>947</locationY>
        <customErrorMessages>
            <errorMessage>Unknown Record Type: {!$Record.RecordType.Name}</errorMessage>
            <isFieldError>false</isFieldError>
        </customErrorMessages>
    </customErrors>
    <customErrors>
        <name>No_Recipient_Error</name>
        <label>No Recipient Error</label>
        <locationX>1810</locationX>
        <locationY>539</locationY>
        <customErrorMessages>
            <errorMessage>You cannot have an opportunity without either Lead, Account or Contact related</errorMessage>
            <isFieldError>false</isFieldError>
        </customErrorMessages>
    </customErrors>
    <decisions>
        <name>Did_we_find_any_Opp_Products</name>
        <label>Did we find any Opp Products?</label>
        <locationX>1194</locationX>
        <locationY>1571</locationY>
        <defaultConnector>
            <targetReference>Custom_Error_No_Products_on_Opportunity</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Opp_Products_Exist</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Get_Opportunity_Products</leftValueReference>
                <operator>IsEmpty</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Does_Opp_have_a_Price_Book</targetReference>
            </connector>
            <label>Opp Products Exist</label>
        </rules>
    </decisions>
    <decisions>
        <name>Does_Opp_have_a_Price_Book</name>
        <label>Does Opp have a Price Book?</label>
        <locationX>842</locationX>
        <locationY>1679</locationY>
        <defaultConnector>
            <targetReference>Custom_Error_Cannot_Convert_Opp_without_Price_Book</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>Price_Book_Exists</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Pricebook2Id</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Get_Price_Book</targetReference>
            </connector>
            <label>Price Book Exists</label>
        </rules>
    </decisions>
    <decisions>
        <name>Does_Opp_Have_an_Account</name>
        <label>Does Opp Have an Account?</label>
        <locationX>402</locationX>
        <locationY>1895</locationY>
        <defaultConnector>
            <targetReference>Does_Opp_Have_Lead</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No Account on Opp</defaultConnectorLabel>
        <rules>
            <name>Opp_has_Account</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.AccountId</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Assign_Opp_s_Account_ID_to_Variable</targetReference>
            </connector>
            <label>Opp has Account</label>
        </rules>
    </decisions>
    <decisions>
        <name>Does_Opp_Have_Lead</name>
        <label>Does Opp Have Lead?</label>
        <locationX>754</locationX>
        <locationY>2003</locationY>
        <defaultConnector>
            <targetReference>Custom_Error_No_Lead_or_Account_for_Convert</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No Valid Association</defaultConnectorLabel>
        <rules>
            <name>Opp_has_Lead</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Lead__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Get_Lead</targetReference>
            </connector>
            <label>Opp has Lead</label>
        </rules>
    </decisions>
    <decisions>
        <name>Does_Opportunity_have_a_Recipient_Record_related_to_it</name>
        <label>Does Opportunity have a Recipient Record related to it?</label>
        <locationX>1414</locationX>
        <locationY>431</locationY>
        <defaultConnector>
            <targetReference>No_Recipient_Error</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>No Recipient Related</defaultConnectorLabel>
        <rules>
            <name>Recipient_Account</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.AccountId</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Assign_Account_as_Recipient_ID</targetReference>
            </connector>
            <label>Recipient Account</label>
        </rules>
        <rules>
            <name>Recipient_Contact</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.ContactId</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Assign_Contact_as_Recipient_ID</targetReference>
            </connector>
            <label>Recipient Contact</label>
        </rules>
        <rules>
            <name>Recipient_Lead</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Lead__c</leftValueReference>
                <operator>IsNull</operator>
                <rightValue>
                    <booleanValue>false</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Assign_Lead_as_Recipient_ID</targetReference>
            </connector>
            <label>Recipient Lead</label>
        </rules>
    </decisions>
    <decisions>
        <name>Is_Lead_Converted</name>
        <label>Is Lead Converted?</label>
        <locationX>490</locationX>
        <locationY>2327</locationY>
        <defaultConnector>
            <targetReference>Lead_Convert_Action</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Lead Not Converted</defaultConnectorLabel>
        <rules>
            <name>Lead_is_Converted</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>Get_Lead.IsConverted</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Get_Account_from_Lead</targetReference>
            </connector>
            <label>Lead is Converted</label>
        </rules>
    </decisions>
    <decisions>
        <name>Should_we_Notify_Owner</name>
        <label>Should we Notify Owner?</label>
        <locationX>1414</locationX>
        <locationY>4163</locationY>
        <defaultConnector>
            <targetReference>Update_Opportunity</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Do not Notify</defaultConnectorLabel>
        <rules>
            <name>Notify_Owner</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.Notify_Owner__c</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Assign_Email_Values_and_Reset_Notify_Field</targetReference>
            </connector>
            <label>Notify Owner</label>
        </rules>
    </decisions>
    <decisions>
        <name>Was_Conversion_Successful</name>
        <label>Was Conversion Successful?</label>
        <locationX>666</locationX>
        <locationY>2543</locationY>
        <defaultConnector>
            <targetReference>Failed_to_Convert_Lead</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Conversion Failed</defaultConnectorLabel>
        <rules>
            <name>Conversion_Success</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>IsConvertSuccess</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Create_Order</targetReference>
            </connector>
            <label>Conversion Success</label>
        </rules>
    </decisions>
    <decisions>
        <name>Was_Stage_Changed</name>
        <label>Was Stage Changed?</label>
        <locationX>1414</locationX>
        <locationY>1247</locationY>
        <defaultConnector>
            <targetReference>Should_we_Notify_Owner</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Stage Not Changed</defaultConnectorLabel>
        <rules>
            <name>Stage_Changed</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.StageName</leftValueReference>
                <operator>IsChanged</operator>
                <rightValue>
                    <booleanValue>true</booleanValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>What_was_Stage_Changed_Into</targetReference>
            </connector>
            <label>Stage Changed</label>
        </rules>
    </decisions>
    <decisions>
        <name>What_is_the_Opportunity_s_Record_Type</name>
        <label>What is the Opportunity&apos;s Record Type?</label>
        <locationX>1414</locationX>
        <locationY>839</locationY>
        <defaultConnector>
            <targetReference>Invalid_Record_Type_Error</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Invalid Record Type</defaultConnectorLabel>
        <rules>
            <name>Internal_Real_Estate_Administration</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.RecordType.DeveloperName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Internal_Real_Estate_Administration</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Was_Stage_Changed</targetReference>
            </connector>
            <label>Internal Real Estate Administration</label>
        </rules>
        <rules>
            <name>Private_Inheritance_Law</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.RecordType.DeveloperName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Private_Inheritance_Law</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Was_Stage_Changed</targetReference>
            </connector>
            <label>Private Inheritance Law</label>
        </rules>
        <rules>
            <name>Customer_Care</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.RecordType.DeveloperName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Customer_Care</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <isGoTo>true</isGoTo>
                <targetReference>Should_we_Notify_Owner</targetReference>
            </connector>
            <label>Customer Care</label>
        </rules>
    </decisions>
    <decisions>
        <name>What_was_Stage_Changed_Into</name>
        <label>What was Stage Changed Into?</label>
        <locationX>666</locationX>
        <locationY>1355</locationY>
        <defaultConnector>
            <targetReference>Should_we_Notify_Owner</targetReference>
        </defaultConnector>
        <defaultConnectorLabel>Default Outcome</defaultConnectorLabel>
        <rules>
            <name>To_Qualification</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.StageName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Qualification</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Should_we_Notify_Owner</targetReference>
            </connector>
            <label>To Qualification</label>
        </rules>
        <rules>
            <name>To_Needs_Analysis</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.StageName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Needs Analysis</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Should_we_Notify_Owner</targetReference>
            </connector>
            <label>To Needs Analysis</label>
        </rules>
        <rules>
            <name>To_Proposal</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.StageName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Proposal</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Should_we_Notify_Owner</targetReference>
            </connector>
            <label>To Proposal</label>
        </rules>
        <rules>
            <name>To_Negotiation</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.StageName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Negotiation</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Should_we_Notify_Owner</targetReference>
            </connector>
            <label>To Negotiation</label>
        </rules>
        <rules>
            <name>To_Closed_Won</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.StageName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Closed Won</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Get_Opportunity_Products</targetReference>
            </connector>
            <label>To Closed Won</label>
        </rules>
        <rules>
            <name>To_Closed_Lost</name>
            <conditionLogic>and</conditionLogic>
            <conditions>
                <leftValueReference>$Record.StageName</leftValueReference>
                <operator>EqualTo</operator>
                <rightValue>
                    <stringValue>Closed Lost</stringValue>
                </rightValue>
            </conditions>
            <connector>
                <targetReference>Should_we_Notify_Owner</targetReference>
            </connector>
            <label>To Closed Lost</label>
        </rules>
    </decisions>
    <environments>Default</environments>
    <formulas>
        <name>frmDiscount</name>
        <dataType>Number</dataType>
        <expression>IF(ISBLANK({!Loop_Opp_Products.Discount}), 0, {!Loop_Opp_Products.Discount})</expression>
        <scale>2</scale>
    </formulas>
    <interviewLabel>Record-Triggered: Opportunity is Updated {!$Flow.CurrentDateTime}</interviewLabel>
    <label>Record-Triggered: Opportunity is Updated</label>
    <loops>
        <name>Loop_Opp_Products</name>
        <label>Loop Opp Products</label>
        <locationX>402</locationX>
        <locationY>3311</locationY>
        <collectionReference>Get_Opportunity_Products</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Populate_Order_Product_Variable</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Create_Order_Products</targetReference>
        </noMoreValuesConnector>
    </loops>
    <processMetadataValues>
        <name>BuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>CanvasMode</name>
        <value>
            <stringValue>AUTO_LAYOUT_CANVAS</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>OriginBuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processType>AutoLaunchedFlow</processType>
    <recordCreates>
        <name>Create_Order</name>
        <label>Create Order</label>
        <locationX>402</locationX>
        <locationY>3095</locationY>
        <assignRecordIdToReference>orderId</assignRecordIdToReference>
        <connector>
            <targetReference>Populate_Order_and_Account_on_Opportunity</targetReference>
        </connector>
        <inputAssignments>
            <field>AccountId</field>
            <value>
                <elementReference>accountId</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Campaign__c</field>
            <value>
                <elementReference>$Record.Marketing_Campaign__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>CurrencyIsoCode</field>
            <value>
                <elementReference>$Record.CurrencyIsoCode</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>EffectiveDate</field>
            <value>
                <elementReference>$Flow.CurrentDate</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Lead__c</field>
            <value>
                <elementReference>leadId</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Market_Unit__c</field>
            <value>
                <elementReference>$Record.Market_Unit__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>OwnerId</field>
            <value>
                <elementReference>$User.Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Pricebook2Id</field>
            <value>
                <elementReference>Get_Price_Book.Id</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Refund_Value__c</field>
            <value>
                <numberValue>0.0</numberValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Status</field>
            <value>
                <stringValue>Draft</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>Type</field>
            <value>
                <stringValue>Real Estate Administration</stringValue>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>UTM_Campaign__c</field>
            <value>
                <elementReference>$Record.UTM_Campaign__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>UTM_Content__c</field>
            <value>
                <elementReference>$Record.UTM_Content__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>UTM_Medium__c</field>
            <value>
                <elementReference>$Record.UTM_Medium__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>UTM_Source__c</field>
            <value>
                <elementReference>$Record.UTM_Source__c</elementReference>
            </value>
        </inputAssignments>
        <inputAssignments>
            <field>UTM_Term__c</field>
            <value>
                <elementReference>$Record.UTM_Term__c</elementReference>
            </value>
        </inputAssignments>
        <object>Order</object>
    </recordCreates>
    <recordCreates>
        <name>Create_Order_Products</name>
        <label>Create Order Products</label>
        <locationX>402</locationX>
        <locationY>3719</locationY>
        <connector>
            <targetReference>Should_we_Notify_Owner</targetReference>
        </connector>
        <inputReference>orderProductCollection</inputReference>
    </recordCreates>
    <recordLookups>
        <name>Get_Account_from_Lead</name>
        <label>Get Account from Lead</label>
        <locationX>314</locationX>
        <locationY>2435</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Populate_Variables_from_Account_from_Lead</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Lead__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>Get_Lead.Id</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Account</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_Lead</name>
        <label>Get Lead</label>
        <locationX>490</locationX>
        <locationY>2111</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Assign_Opp_s_Lead_ID_to_Variable</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.Lead__c</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Lead</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_Opportunity_Products</name>
        <label>Get Opportunity Products</label>
        <locationX>1194</locationX>
        <locationY>1463</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Did_we_find_any_Opp_Products</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>OpportunityId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.Id</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>false</getFirstRecordOnly>
        <object>OpportunityLineItem</object>
        <sortField>Name</sortField>
        <sortOrder>Asc</sortOrder>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_Price_Book</name>
        <label>Get Price Book</label>
        <locationX>402</locationX>
        <locationY>1787</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Does_Opp_Have_an_Account</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.Pricebook2Id</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>Pricebook2</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <description>Currently finds Thomas Kr√ºger&apos;s User searching for his specific User ID</description>
        <name>Get_User_Opportunity_Owner</name>
        <label>Get User (Opportunity Owner)</label>
        <locationX>1414</locationX>
        <locationY>323</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Does_Opportunity_have_a_Recipient_Record_related_to_it</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>$Record.OwnerId</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>User</object>
        <queriedFields>Id</queriedFields>
        <queriedFields>Username</queriedFields>
        <queriedFields>Name</queriedFields>
        <queriedFields>Email</queriedFields>
        <queriedFields>Country__c</queriedFields>
        <queriedFields>Market_Unit__c</queriedFields>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordUpdates>
        <name>Update_Opportunity</name>
        <label>Update Opportunity</label>
        <locationX>1414</locationX>
        <locationY>4571</locationY>
        <inputReference>$Record</inputReference>
    </recordUpdates>
    <start>
        <locationX>1288</locationX>
        <locationY>0</locationY>
        <connector>
            <targetReference>Get_User_Opportunity_Owner</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Category__c</field>
            <operator>NotEqualTo</operator>
            <value>
                <stringValue>Customer Care</stringValue>
            </value>
        </filters>
        <object>Opportunity</object>
        <recordTriggerType>Update</recordTriggerType>
        <triggerType>RecordAfterSave</triggerType>
    </start>
    <status>Obsolete</status>
    <textTemplates>
        <name>rtEmail</name>
        <isViewedAsPlainText>false</isViewedAsPlainText>
        <text>&lt;p&gt;&lt;strong style=&quot;color: rgb(0, 0, 0); font-size: var(--lwc-fontSize6,1.125rem); background-color: var(--slds-g-color-neutral-base-100, var(--lwc-colorBackgroundInput,rgb(255, 255, 255))); font-family: var(--lwc-fontFamily,-apple-system, BlinkMacSystemFont, &apos;Segoe UI&apos;, Roboto, Helvetica, Arial, sans-serif, &apos;Apple Color Emoji&apos;, &apos;Segoe UI Emoji&apos;, &apos;Segoe UI Symbol&apos;);&quot;&gt;An Opportunity was assigned to you&lt;/strong&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;color: rgb(0, 0, 0);&quot;&gt;Hi {!$Record.Owner.FirstName},&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;color: rgb(0, 0, 0);&quot;&gt;Please find the details below:&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;strong style=&quot;color: rgb(0, 0, 0);&quot;&gt;Opportunity Name:&lt;/strong&gt;&lt;span style=&quot;color: rgb(0, 0, 0);&quot;&gt; {!$Record.Name}&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;strong style=&quot;color: rgb(0, 0, 0);&quot;&gt;Stage:&lt;/strong&gt;&lt;span style=&quot;color: rgb(0, 0, 0);&quot;&gt; {!$Record.StageName}&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;strong style=&quot;color: rgb(0, 0, 0);&quot;&gt;Estimated Value:&lt;/strong&gt;&lt;span style=&quot;color: rgb(0, 0, 0);&quot;&gt; {!$Record.Amount}&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;strong style=&quot;color: rgb(0, 0, 0);&quot;&gt;Estimated Close Date:&lt;/strong&gt;&lt;span style=&quot;color: rgb(0, 0, 0);&quot;&gt; {!$Record.CloseDate}&lt;/span&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;a href=&quot;https://dfj.lightning.force.com/lightning/r/{!$Record.Id}/view&quot; rel=&quot;noopener noreferrer&quot; target=&quot;_blank&quot;&gt;View Opportunity&lt;/a&gt;&lt;/p&gt;&lt;p&gt;&lt;br&gt;&lt;/p&gt;&lt;p&gt;&lt;span style=&quot;color: rgb(0, 0, 0);&quot;&gt;This is an automated notification from Salesforce. Please do not reply.&lt;/span&gt;&lt;/p&gt;</text>
    </textTemplates>
    <variables>
        <name>accountId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>CustomError</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>emailBody</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>emailSubject</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>FixedDiscountAmount</name>
        <dataType>Number</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <scale>2</scale>
        <value>
            <numberValue>0.0</numberValue>
        </value>
    </variables>
    <variables>
        <name>fromEmail</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>IsConvertSuccess</name>
        <dataType>Boolean</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <value>
            <booleanValue>false</booleanValue>
        </value>
    </variables>
    <variables>
        <name>leadId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>orderId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>orderProduct</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>OrderItem</objectType>
    </variables>
    <variables>
        <name>orderProductCollection</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>OrderItem</objectType>
    </variables>
    <variables>
        <name>orderRecord</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Order</objectType>
    </variables>
    <variables>
        <name>PriceBook2Id</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>recipientId</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>toEmail</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
</Flow>
