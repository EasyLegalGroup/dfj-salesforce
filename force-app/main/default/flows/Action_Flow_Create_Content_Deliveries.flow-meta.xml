<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata">
    <apiVersion>61.0</apiVersion>
    <assignments>
        <name>Assign_Content_Deliveries_to_Collection</name>
        <label>Assign Content Deliveries to Collection</label>
        <locationX>264</locationX>
        <locationY>566</locationY>
        <assignmentItems>
            <assignToReference>contentDeliveriesCollection</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>contentDeliveryRecord</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Loop_Content_Document_Links</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_Content_Document_Links_to_Collection</name>
        <label>Assign Content Document Links to Collection</label>
        <locationX>264</locationX>
        <locationY>1706</locationY>
        <assignmentItems>
            <assignToReference>contentDocumentLinkCollection</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>contentDocumentLinkRecord</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Loop_Shared_Documents</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_Shared_Documents_to_Collection</name>
        <label>Assign Shared Documents to Collection</label>
        <locationX>264</locationX>
        <locationY>1190</locationY>
        <assignmentItems>
            <assignToReference>sharedDocumentsCollection</assignToReference>
            <operator>Add</operator>
            <value>
                <elementReference>sharedDocumentRecord</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Loop_Content_Deliveries</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Assign_Values_to_Document_Link</name>
        <label>Assign Values to Content Document Link</label>
        <locationX>264</locationX>
        <locationY>1598</locationY>
        <assignmentItems>
            <assignToReference>contentDocumentLinkRecord.LinkedEntityId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_Shared_Documents.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>contentDocumentLinkRecord.ContentDocumentId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_Shared_Documents.Content_Document_ID__c</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Assign_Content_Document_Links_to_Collection</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Create_Shared_Document_Record</name>
        <label>Create Shared Document Record</label>
        <locationX>264</locationX>
        <locationY>1082</locationY>
        <assignmentItems>
            <assignToReference>sharedDocumentRecord.Allow_Download_as_PDF__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_Content_Deliveries.PreferencesAllowPDFDownload</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>sharedDocumentRecord.Allow_Download_in_Original_Format__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_Content_Deliveries.PreferencesAllowOriginalDownload</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>sharedDocumentRecord.Allow_View_in_Browser__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_Content_Deliveries.PreferencesAllowViewInBrowser</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>sharedDocumentRecord.Content_Delivery_Expires__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_Content_Deliveries.PreferencesExpires</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>sharedDocumentRecord.Content_Delivery_ID__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_Content_Deliveries.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>sharedDocumentRecord.Content_Delivery_Opens_Latest_Version__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_Content_Deliveries.PreferencesLinkLatestVersion</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>sharedDocumentRecord.ContentVersion_ID__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_Content_Deliveries.ContentVersionId</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>sharedDocumentRecord.CreatedById</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_Content_Deliveries.CreatedById</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>sharedDocumentRecord.CreatedDate</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_Content_Deliveries.CreatedDate</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>sharedDocumentRecord.Email_when_Preview_Images_are_Ready__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_Content_Deliveries.PreferencesNotifyRndtnComplete</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>sharedDocumentRecord.Expiration_Date__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_Content_Deliveries.ExpiryDate</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>sharedDocumentRecord.External_Link__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_Content_Deliveries.DistributionPublicUrl</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>sharedDocumentRecord.First_Viewed__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_Content_Deliveries.FirstViewDate</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>sharedDocumentRecord.File_Download_Link__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_Content_Deliveries.ContentDownloadUrl</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>sharedDocumentRecord.LastViewedDate</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_Content_Deliveries.LastViewDate</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>sharedDocumentRecord.Name</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_Content_Deliveries.Name</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>sharedDocumentRecord.Notify_Me_of_First_View_or_Download__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_Content_Deliveries.PreferencesNotifyOnVisit</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>sharedDocumentRecord.OwnerId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_Content_Deliveries.OwnerId</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>sharedDocumentRecord.Password__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_Content_Deliveries.Password</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>sharedDocumentRecord.Related_Record_ID__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_Content_Deliveries.RelatedRecordId</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>sharedDocumentRecord.PDF_Download_Link__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_Content_Deliveries.PdfDownloadUrl</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>sharedDocumentRecord.Require_Password_to_Access_Content__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_Content_Deliveries.PreferencesPasswordRequired</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>sharedDocumentRecord.Account__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>recordId.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>sharedDocumentRecord.Content_Document_ID__c</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_Content_Deliveries.ContentDocumentId</elementReference>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Assign_Shared_Documents_to_Collection</targetReference>
        </connector>
    </assignments>
    <assignments>
        <name>Populate_Content_Delivery_Record_Variable</name>
        <label>Populate Content Delivery Record Variable</label>
        <locationX>264</locationX>
        <locationY>458</locationY>
        <assignmentItems>
            <assignToReference>contentDeliveryRecord.ContentVersionId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_Content_Version.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>contentDeliveryRecord.ExpiryDate</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>TodayPlus30Days</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>contentDeliveryRecord.PreferencesPasswordRequired</assignToReference>
            <operator>Assign</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>contentDeliveryRecord.Name</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Get_Content_Version.ContentDocument.Title</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>contentDeliveryRecord.PreferencesExpires</assignToReference>
            <operator>Assign</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>contentDeliveryRecord.PreferencesAllowViewInBrowser</assignToReference>
            <operator>Assign</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>contentDeliveryRecord.RelatedRecordId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>recordId.Id</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>contentDeliveryRecord.ContentDocumentId</assignToReference>
            <operator>Assign</operator>
            <value>
                <elementReference>Loop_Content_Document_Links.ContentDocumentId</elementReference>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>contentDeliveryRecord.PreferencesAllowOriginalDownload</assignToReference>
            <operator>Assign</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>contentDeliveryRecord.PreferencesAllowPDFDownload</assignToReference>
            <operator>Assign</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>contentDeliveryRecord.PreferencesLinkLatestVersion</assignToReference>
            <operator>Assign</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>contentDeliveryRecord.PreferencesNotifyOnVisit</assignToReference>
            <operator>Assign</operator>
            <value>
                <booleanValue>true</booleanValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>Assign_Content_Deliveries_to_Collection</targetReference>
        </connector>
    </assignments>
    <environments>Default</environments>
    <formulas>
        <name>TodayPlus30Days</name>
        <dataType>Date</dataType>
        <expression>TODAY()+30</expression>
    </formulas>
    <interviewLabel>Action Flow: Create Content Deliveries {!$Flow.CurrentDateTime}</interviewLabel>
    <label>Action Flow: Create Content Deliveries</label>
    <loops>
        <name>Loop_Content_Deliveries</name>
        <label>Loop Content Deliveries</label>
        <locationX>176</locationX>
        <locationY>974</locationY>
        <collectionReference>Get_Content_Deliveries</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Create_Shared_Document_Record</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Create_Shared_Documents</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <name>Loop_Content_Document_Links</name>
        <label>Loop Content Document Links</label>
        <locationX>176</locationX>
        <locationY>242</locationY>
        <collectionReference>Get_Content_Document_Links</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Get_Content_Version</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Create_Content_Deliveries</targetReference>
        </noMoreValuesConnector>
    </loops>
    <loops>
        <name>Loop_Shared_Documents</name>
        <label>Loop Shared Documents</label>
        <locationX>176</locationX>
        <locationY>1490</locationY>
        <collectionReference>sharedDocumentsCollection</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Assign_Values_to_Document_Link</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>Create_Content_Document_Links_to_Shared_Document</targetReference>
        </noMoreValuesConnector>
    </loops>
    <processMetadataValues>
        <name>BuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>CanvasMode</name>
        <value>
            <stringValue>AUTO_LAYOUT_CANVAS</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>OriginBuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processType>AutoLaunchedFlow</processType>
    <recordCreates>
        <name>Create_Content_Deliveries</name>
        <label>Create Content Deliveries</label>
        <locationX>176</locationX>
        <locationY>758</locationY>
        <connector>
            <targetReference>Get_Content_Deliveries</targetReference>
        </connector>
        <inputReference>contentDeliveriesCollection</inputReference>
    </recordCreates>
    <recordCreates>
        <name>Create_Content_Document_Links_to_Shared_Document</name>
        <label>Create Content Document Links to Shared Document</label>
        <locationX>176</locationX>
        <locationY>1898</locationY>
        <inputReference>contentDocumentLinkCollection</inputReference>
    </recordCreates>
    <recordCreates>
        <name>Create_Shared_Documents</name>
        <label>Create Shared Documents</label>
        <locationX>176</locationX>
        <locationY>1382</locationY>
        <connector>
            <targetReference>Loop_Shared_Documents</targetReference>
        </connector>
        <inputReference>sharedDocumentsCollection</inputReference>
    </recordCreates>
    <recordLookups>
        <name>Get_Content_Deliveries</name>
        <label>Get Content Deliveries</label>
        <locationX>176</locationX>
        <locationY>866</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Loop_Content_Deliveries</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>RelatedRecordId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>recordId.Id</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>false</getFirstRecordOnly>
        <object>ContentDistribution</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_Content_Document_Links</name>
        <label>Get Content Document Links</label>
        <locationX>176</locationX>
        <locationY>134</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Loop_Content_Document_Links</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>LinkedEntityId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>recordId.Id</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>false</getFirstRecordOnly>
        <object>ContentDocumentLink</object>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <recordLookups>
        <name>Get_Content_Version</name>
        <label>Get Content Version</label>
        <locationX>264</locationX>
        <locationY>350</locationY>
        <assignNullValuesIfNoRecordsFound>false</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>Populate_Content_Delivery_Record_Variable</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>ContentDocumentId</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>Loop_Content_Document_Links.ContentDocumentId</elementReference>
            </value>
        </filters>
        <getFirstRecordOnly>true</getFirstRecordOnly>
        <object>ContentVersion</object>
        <sortField>CreatedDate</sortField>
        <sortOrder>Desc</sortOrder>
        <storeOutputAutomatically>true</storeOutputAutomatically>
    </recordLookups>
    <start>
        <locationX>50</locationX>
        <locationY>0</locationY>
        <connector>
            <targetReference>Get_Content_Document_Links</targetReference>
        </connector>
    </start>
    <status>Draft</status>
    <variables>
        <name>contentDeliveriesCollection</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>ContentDistribution</objectType>
    </variables>
    <variables>
        <name>contentDeliveryRecord</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>ContentDistribution</objectType>
    </variables>
    <variables>
        <name>contentDocumentLinkCollection</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>ContentDocumentLink</objectType>
    </variables>
    <variables>
        <name>contentDocumentLinkRecord</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>ContentDocumentLink</objectType>
    </variables>
    <variables>
        <name>recordId</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>false</isOutput>
        <objectType>Account</objectType>
    </variables>
    <variables>
        <name>sharedDocumentRecord</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Shared_Document__c</objectType>
    </variables>
    <variables>
        <name>sharedDocumentsCollection</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Shared_Document__c</objectType>
    </variables>
</Flow>
